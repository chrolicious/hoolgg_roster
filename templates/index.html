<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hool.gg Roster - WoW Character Tracker</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/driver.js@1.3.1/dist/driver.css">
</head>
<body>
    <header>
        <!-- Window Controls (Electron only) -->
        <div class="window-controls" id="windowControls" style="display: none;">
            <button class="window-control-btn minimize" id="minimizeBtn" title="Minimize">
                <svg viewBox="0 0 12 12">
                    <rect x="0" y="5" width="12" height="2"/>
                </svg>
            </button>
            <button class="window-control-btn maximize" id="maximizeBtn" title="Maximize">
                <svg viewBox="0 0 12 12">
                    <rect x="1" y="1" width="10" height="10" stroke="currentColor" stroke-width="1.5" fill="none"/>
                </svg>
            </button>
            <button class="window-control-btn close" id="closeBtn" title="Close">
                <svg viewBox="0 0 12 12">
                    <line x1="1" y1="1" x2="11" y2="11" stroke="currentColor" stroke-width="1.5"/>
                    <line x1="11" y1="1" x2="1" y2="11" stroke="currentColor" stroke-width="1.5"/>
                </svg>
            </button>
        </div>
        <div class="header-content">
            <div class="header-left">
                <div class="logo">
                    <img src="{{ url_for('static', filename='hoolio-logo.png') }}?v=4" alt="Hool.gg Logo" class="logo-icon">
                    <div class="logo-text">
                        <h1>Hool.gg</h1>
                        <p class="tagline">Character & Crafting<br>Progression Tracker</p>
                    </div>
                </div>
            </div>
            <div class="header-center">
                <!-- Week Selector Dropdown -->
                <div class="week-selector-dropdown">
                    <svg class="dropdown-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <select id="weekSelect" class="week-select"></select>
                </div>
                <!-- Tab Navigation -->
                <nav class="tabs">
                    <button class="tab active" data-tab="dashboard">Dashboard</button>
                    <button class="tab" data-tab="timeline">Timeline</button>
                    <button class="tab" data-tab="crest-ledger">Crest Ledger</button>
                    <button class="tab" data-tab="profession-hub">Profession Hub</button>
                    <button class="tab" data-tab="settings">Settings</button>
                </nav>
            </div>
        </div>
    </header>

    <main>
        <!-- Dashboard View -->
        <div id="dashboard" class="view active">
            <div class="dashboard-grid" id="dashboardGrid"></div>
        </div>

        <!-- Timeline View -->
        <div id="timeline" class="view">
            <h2>Timeline</h2>
            <div class="timeline" id="timelineContent"></div>
        </div>

        <!-- Crest Ledger View -->
        <div id="crest-ledger" class="view">
            <h2>Crest Ledger</h2>
            <p class="text-muted">Weekly cap: 90 per type | Enter your weekly collection, totals accumulate automatically</p>
            <div class="crest-table-container">
                <table class="crest-table" id="crestTable"></table>
            </div>
        </div>

        <!-- Profession Hub View -->
        <div id="profession-hub" class="view">
            <h2>Profession Hub</h2>
            <div class="profession-table-container">
                <table class="profession-table" id="professionTable"></table>
            </div>
        </div>

        <!-- Settings View -->
        <div id="settings" class="view">
            <h2>Settings</h2>
            <div class="settings-section">
                <h3>Blizzard API Configuration</h3>
                <div class="info-box">
                    <p class="info-box-title">Why do I need API credentials?</p>
                    <p class="info-box-text text-muted">
                        API credentials allow the app to <strong>automatically sync your character's current gear, stats, and item levels</strong> directly from the Blizzard Armory.
                        Without them, you'll need to manually update your gear after every change.
                    </p>
                    <p class="info-box-text text-muted" style="margin: 0;">
                        Get your free API credentials at <a href="https://develop.battle.net/" target="_blank" style="color: var(--hool-primary-blue); text-decoration: underline;">develop.battle.net</a>
                        (takes ~2 minutes). Your credentials stay on your device and are never sent anywhere else.
                    </p>
                </div>
                <div class="form-group">
                    <label for="clientId">Client ID</label>
                    <input type="text" id="clientId" placeholder="Enter your Blizzard API Client ID">
                </div>
                <div class="form-group">
                    <label for="clientSecret">Client Secret</label>
                    <input type="password" id="clientSecret" placeholder="Enter your Blizzard API Client Secret">
                </div>
                <div class="form-group">
                    <label for="region">Region</label>
                    <select id="region">
                        <option value="us">US</option>
                        <option value="eu">EU</option>
                        <option value="kr">KR</option>
                        <option value="tw">TW</option>
                    </select>
                </div>
                <button class="btn-primary" id="saveApiConfig">Save API Configuration</button>
            </div>

            <div class="settings-section">
                <h3>Character Configuration</h3>
                <div class="info-box">
                    <p class="info-box-title">Add Your Characters</p>
                    <p class="info-box-text text-muted" style="margin: 0;">
                        Add the characters you want to track by entering their <strong>realm</strong> and <strong>character name</strong>.
                        You can track up to 6 characters. Once added and API credentials are configured, click "Sync All Gear" on the Dashboard to automatically import their current gear and stats.
                    </p>
                </div>
                <div class="character-config-grid" id="characterConfigGrid"></div>
            </div>

            <div class="settings-section">
                <h3>Utilities</h3>
                <button class="btn-secondary" id="resetDailyBtn">Reset Daily Checklists</button>
                <button class="btn-secondary" id="restartTourBtn" style="margin-left: 12px;" onclick="restartTourHandler()">Restart Guided Tour</button>
            </div>
        </div>
    </main>

    <script>const whTooltips = {colorLinks: true, iconizeLinks: true, renameLinks: true};</script>
    <script src="https://wow.zamimg.com/js/tooltips.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/driver.js@1.3.1/dist/driver.js.iife.js"></script>
    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>

    <!-- Custom Modal for Character Input -->
    <div id="characterModal" class="modal" style="display: none;">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <h3>Add New Character</h3>
            <div class="form-group">
                <label for="modalCharacterName">Character Name</label>
                <input type="text" id="modalCharacterName" placeholder="Enter character name">
            </div>
            <div class="form-group">
                <label for="modalRealm">Realm</label>
                <input type="text" id="modalRealm" placeholder="Enter realm name">
            </div>
            <div style="display: flex; gap: 12px; margin-top: 20px;">
                <button class="btn-primary" id="modalAddBtn">Add Character</button>
                <button class="btn-secondary" id="modalCancelBtn">Cancel</button>
            </div>
        </div>
    </div>
